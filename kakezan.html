<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>è¨ˆç®—ã‚¯ã‚¤ã‚º</title>
    <style>
      body {
        width: auto;
        height: auto;
        font-size: 20px;
      }
      .hidden {
        display: none;
      }
      input[type="button"] {
        background-color: #000FFF;
        color: #FFFFFF;
        width: 150px;
        height: 30px;
        border-radius: 10px;
        border: none;
        margin: 5px;
        cursor: pointer;
      }
      input[type="number"] {
        background-color: #FFFFFF;
        color: #000000;
        width: 150px;
        height: 30px;
        border-radius: 10px;
        margin: 5px;
      }
      .hint-text {
        font-size: 20px;
        white-space: pre-wrap; /* æ”¹è¡Œã‚’æœ‰åŠ¹ã«ã™ã‚‹ */
      }
    </style>
  </head>
  <body>
    <h1>è¨ˆç®—ã‚¯ã‚¤ã‚º</h1>
    <br />
    <p id="instruction">ã©ã‚Œã‹é¸ã‚“ã§ã­</p>

    <div id="quiz-menu">
      <input type="button" onclick="startQuiz('plus')" value="ãŸã—ã–ã‚“">
      <input type="button" onclick="startQuiz('minus')" value="ã²ãã–ã‚“">
      <br>
      <input type="button" onclick="startQuiz('times')" value="ã‹ã‘ã–ã‚“">
      <input type="button" onclick="startQuiz('divide')" value="ã‚ã‚Šã–ã‚“">
    </div>

    <div id="quiz-container"></div>

    <script>
      let currentAnswer = 0;
      let currentQuestionNumber = 0;
      let quizType = ''; // ã©ã®ã‚¯ã‚¤ã‚ºã‹ã‚’ä¿æŒã™ã‚‹å¤‰æ•°

      const quizMenu = document.getElementById('quiz-menu');
      const quizContainer = document.getElementById('quiz-container');
      const instruction = document.getElementById('instruction');

      function startQuiz(type) {
        quizType = type; // ã‚¯ã‚¤ã‚ºã®ç¨®é¡ã‚’ä¿å­˜
        instruction.classList.add('hidden');
        quizMenu.classList.add('hidden');
        currentQuestionNumber = 0; // æ–°ã—ã„ã‚¯ã‚¤ã‚ºé–‹å§‹æ™‚ã«å•é¡Œæ•°ã‚’ãƒªã‚»ãƒƒãƒˆ

        if (type === 'times') {
          showTimesMenu();
        } else {
          generateQuestion();
        }
      }

      function showTimesMenu() {
        let buttons = '';
        for (let i = 1; i <= 9; i++) {
          buttons += `<input type="button" onclick="startTimesQuiz(${i})" value="${i}ã®æ®µ">`;
        }
        buttons += `<br><input type="button" onclick="startTimesQuiz('random')" value="ãƒ©ãƒ³ãƒ€ãƒ ãªã‹ã‘ã–ã‚“">`;
        buttons += `<br><input type="button" onclick="resetQuiz()" value="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹">`;

        quizContainer.innerHTML = `<p>æ®µã‚’é¸ã‚“ã§ã­</p>${buttons}`;
      }

      function startTimesQuiz(dan) {
        quizType = `times_${dan}`;
        generateQuestion();
      }

      function generateQuestion() {
        let num1, num2, questionText;
        currentQuestionNumber++;
        let hintText = ''; // ãƒ’ãƒ³ãƒˆç”¨ã®å¤‰æ•°ã‚’åˆæœŸåŒ–

        if (quizType === 'plus') {
          num1 = Math.floor(Math.random() * 100);
          num2 = Math.floor(Math.random() * 100);
          questionText = `${num1} + ${num2} = ?`;
          currentAnswer = num1 + num2;
        } else if (quizType === 'minus') {
          num1 = Math.floor(Math.random() * 100);
          num2 = Math.floor(Math.random() * 100);
          if (num1 < num2) {
            [num1, num2] = [num2, num1];
          }
          questionText = `${num1} - ${num2} = ?`;
          currentAnswer = num1 - num2;
        } else if (quizType.startsWith('times_')) {
          const dan = quizType.split('_')[1];
          if (dan === 'random') {
            num1 = Math.floor(Math.random() * 9) + 1;
            num2 = Math.floor(Math.random() * 9) + 1;
          } else {
            num1 = parseInt(dan);
            num2 = Math.floor(Math.random() * 9) + 1;
          }
          questionText = `${num1} Ã— ${num2} = ?`;
          currentAnswer = num1 * num2;
          
          // æ›ã‘ç®—ã®ãƒ’ãƒ³ãƒˆã‚’ç”Ÿæˆ
          let hintHtml = '';
          for (let i = 0; i < num1; i++) {
            for (let j = 0; j < num2; j++) {
              hintHtml += 'ğŸ';
            }
            hintHtml += ' '; // å„ã‚°ãƒ«ãƒ¼ãƒ—ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹
          }
          hintText = `<p class="hint-text">${hintHtml}</p>`;
        } else if (quizType === 'divide') {
          num2 = Math.floor(Math.random() * 10) + 1;
          let tempResult = Math.floor(Math.random() * 10) + 1;
          num1 = num2 * tempResult;
          questionText = `${num1} Ã· ${num2} = ?`;
          currentAnswer = tempResult;
        }

        quizContainer.innerHTML = `
          <p>${currentQuestionNumber}å•ç›®</p>
          <p>${questionText}</p>
          ${hintText}
          <input type="number" id="user-answer">
          <br>
          <input type="button" onclick="checkAnswer()" value="ã“ãŸãˆã‚‹">
          <p id="result"></p>
        `;
      }

      function checkAnswer() {
        const userAnswer = document.getElementById('user-answer').value;
        const resultParagraph = document.getElementById('result');

        if (parseInt(userAnswer, 10) === currentAnswer) {
          resultParagraph.innerText = 'ã›ã„ã‹ã„ï¼';
        } else {
          resultParagraph.innerText = `ã–ã‚“ã­ã‚“ï¼ã›ã„ã‹ã„ã¯ ${currentAnswer} ã§ã™ã€‚`;
        }

        resultParagraph.innerHTML += `
          <br>
          <input type="button" onclick="generateQuestion()" value="æ¬¡ã®å•é¡Œã¸">
          <input type="button" onclick="resetQuiz()" value="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã‚‹">
        `;
      }

      function resetQuiz() {
        currentQuestionNumber = 0;
        quizContainer.innerHTML = '';
        quizMenu.classList.remove('hidden');
        instruction.classList.remove('hidden');
      }
    </script>
  </body>
</html>
